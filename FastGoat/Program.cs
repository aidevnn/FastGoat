using System.Collections;
using System.ComponentModel;
using System.Diagnostics;
using System.Numerics;
using FastGoat.Commons;
using FastGoat.Examples;
using FastGoat.Structures;
using FastGoat.Structures.CartesianProduct;
using FastGoat.Structures.GenericGroup;
using FastGoat.Structures.Naming;
using FastGoat.Structures.VecSpace;
using FastGoat.UserGroup;
using FastGoat.UserGroup.Characters;
using FastGoat.UserGroup.GModuleN;
using FastGoat.UserGroup.Integers;
using FastGoat.UserGroup.Matrix;
using FastGoat.UserGroup.Perms;
using FastGoat.UserGroup.Polynoms;
using FastGoat.UserGroup.Words;
using FastGoat.UserGroup.Words.ToddCoxeter;
using static FastGoat.Commons.IntExt;
using static FastGoat.Commons.EnumerableExt;
using FastGoat.UserGroup.Padic;
using GroupRegX = System.Text.RegularExpressions.Group;

//////////////////////////////////
//                              //
//    Work Table for crafting   //
//                              //
//////////////////////////////////

Console.WriteLine("Hello World");

{
    var x = FG.QPoly();
    var (minPoly, _, _, _) = IntFactorisation.PrimitiveElt(x.Pow(2) + 1, x.Pow(8) - 2)[0];
    
    var O1 = 120; // rounding digits
    var O2 = 140; // maximum precision digits
    GlobalStopWatch.Restart();
    var galGr = AlgebraicIntegerRelationLLL.GaloisGroupLLL(minPoly, O1, O2);
    var X = FG.KPoly('X', galGr.Neutral().E);
    Console.WriteLine("Prod[X - ri] = {0}", galGr.Aggregate(X.One, (acc, r) => acc * (X - r)));
    GlobalStopWatch.Show("END Roots"); // 
    GlobalStopWatch.AddLap();
    GaloisApplications.GaloisCorrespondence(galGr.ToList());
    GlobalStopWatch.Show("END GaloisCorrespondence");
    
    GlobalStopWatch.Show("END");
}

/*
   With P = X^16 + 8*X^14 + 28*X^12 + 56*X^10 + 66*X^8 + 168*X^6 - 252*X^4 + 120*X^2 + 1
   Factorization in Q(y)/Q
       X + y
       X - y
       X + 19581/118328*y^15 + 77247/59164*y^13 + 265113/59164*y^11 + 1029151/118328*y^9 + 1143663/118328*y^7 + 384912/14791*y^5 - 676680/14791*y^3 + 2688537/118328*y
       X + 76233/473312*y^15 - 3263/473312*y^14 + 608537/473312*y^13 - 24859/473312*y^12 + 2124233/473312*y^11 - 79123/473312*y^10 + 4233543/473312*y^9 - 125631/473312*y^8 + 4948329/473312*y^7 - 66239/473312*y^6 + 12653229/473312*y^5 - 320451/473312*y^4 - 19617275/473312*y^3 + 1179369/473312*y^2 + 9100487/473312*y - 355291/473312
       X + 76233/473312*y^15 + 3263/473312*y^14 + 608537/473312*y^13 + 24859/473312*y^12 + 2124233/473312*y^11 + 79123/473312*y^10 + 4233543/473312*y^9 + 125631/473312*y^8 + 4948329/473312*y^7 + 66239/473312*y^6 + 12653229/473312*y^5 + 320451/473312*y^4 - 19617275/473312*y^3 - 1179369/473312*y^2 + 9100487/473312*y + 355291/473312
       X + 19581/236656*y^15 - 1077/118328*y^14 + 77247/118328*y^13 - 9021/118328*y^12 + 265113/118328*y^11 - 67385/236656*y^10 + 1029151/236656*y^9 - 148683/236656*y^8 + 1143663/236656*y^7 - 26289/29582*y^6 + 192456/14791*y^5 - 119757/59164*y^4 - 338340/14791*y^3 + 220489/236656*y^2 + 2570209/236656*y - 256237/236656
       X + 19581/236656*y^15 + 1077/118328*y^14 + 77247/118328*y^13 + 9021/118328*y^12 + 265113/118328*y^11 + 67385/236656*y^10 + 1029151/236656*y^9 + 148683/236656*y^8 + 1143663/236656*y^7 + 26289/29582*y^6 + 192456/14791*y^5 + 119757/59164*y^4 - 338340/14791*y^3 - 220489/236656*y^2 + 2570209/236656*y + 256237/236656
       X + 2091/473312*y^15 - 3263/473312*y^14 + 9439/473312*y^13 - 24859/473312*y^12 - 3329/473312*y^11 - 79123/473312*y^10 - 116939/473312*y^9 - 125631/473312*y^8 - 373677/473312*y^7 - 66239/473312*y^6 - 336045/473312*y^5 - 320451/473312*y^4 - 2036485/473312*y^3 + 1179369/473312*y^2 + 1180349/473312*y - 355291/473312
       X + 2091/473312*y^15 + 3263/473312*y^14 + 9439/473312*y^13 + 24859/473312*y^12 - 3329/473312*y^11 + 79123/473312*y^10 - 116939/473312*y^9 + 125631/473312*y^8 - 373677/473312*y^7 + 66239/473312*y^6 - 336045/473312*y^5 + 320451/473312*y^4 - 2036485/473312*y^3 - 1179369/473312*y^2 + 1180349/473312*y + 355291/473312
       X - 2091/473312*y^15 - 3263/473312*y^14 - 9439/473312*y^13 - 24859/473312*y^12 + 3329/473312*y^11 - 79123/473312*y^10 + 116939/473312*y^9 - 125631/473312*y^8 + 373677/473312*y^7 - 66239/473312*y^6 + 336045/473312*y^5 - 320451/473312*y^4 + 2036485/473312*y^3 + 1179369/473312*y^2 - 1180349/473312*y - 355291/473312
       X - 2091/473312*y^15 + 3263/473312*y^14 - 9439/473312*y^13 + 24859/473312*y^12 + 3329/473312*y^11 + 79123/473312*y^10 + 116939/473312*y^9 + 125631/473312*y^8 + 373677/473312*y^7 + 66239/473312*y^6 + 336045/473312*y^5 + 320451/473312*y^4 + 2036485/473312*y^3 - 1179369/473312*y^2 - 1180349/473312*y + 355291/473312
       X - 19581/236656*y^15 - 1077/118328*y^14 - 77247/118328*y^13 - 9021/118328*y^12 - 265113/118328*y^11 - 67385/236656*y^10 - 1029151/236656*y^9 - 148683/236656*y^8 - 1143663/236656*y^7 - 26289/29582*y^6 - 192456/14791*y^5 - 119757/59164*y^4 + 338340/14791*y^3 + 220489/236656*y^2 - 2570209/236656*y - 256237/236656
       X - 19581/236656*y^15 + 1077/118328*y^14 - 77247/118328*y^13 + 9021/118328*y^12 - 265113/118328*y^11 + 67385/236656*y^10 - 1029151/236656*y^9 + 148683/236656*y^8 - 1143663/236656*y^7 + 26289/29582*y^6 - 192456/14791*y^5 + 119757/59164*y^4 + 338340/14791*y^3 - 220489/236656*y^2 - 2570209/236656*y + 256237/236656
       X - 76233/473312*y^15 - 3263/473312*y^14 - 608537/473312*y^13 - 24859/473312*y^12 - 2124233/473312*y^11 - 79123/473312*y^10 - 4233543/473312*y^9 - 125631/473312*y^8 - 4948329/473312*y^7 - 66239/473312*y^6 - 12653229/473312*y^5 - 320451/473312*y^4 + 19617275/473312*y^3 + 1179369/473312*y^2 - 9100487/473312*y - 355291/473312
       X - 76233/473312*y^15 + 3263/473312*y^14 - 608537/473312*y^13 + 24859/473312*y^12 - 2124233/473312*y^11 + 79123/473312*y^10 - 4233543/473312*y^9 + 125631/473312*y^8 - 4948329/473312*y^7 + 66239/473312*y^6 - 12653229/473312*y^5 + 320451/473312*y^4 + 19617275/473312*y^3 - 1179369/473312*y^2 - 9100487/473312*y + 355291/473312
       X - 19581/118328*y^15 - 77247/59164*y^13 - 265113/59164*y^11 - 1029151/118328*y^9 - 1143663/118328*y^7 - 384912/14791*y^5 + 676680/14791*y^3 - 2688537/118328*y
   
   Galois Group
   |QD16| = 16
   Type        NonAbelianGroup
   BaseGroup   S16
   SuperGroup  |Gal( Q(y)/Q )| = 16
   
   Elements
   ( 1)[1] = []
   ( 2)[2] = [(1 2)(3 5)(4 7)(6 8)(9 13)(10 14)(11 15)(12 16)]
   ( 3)[2] = [(1 6)(2 8)(3 10)(4 12)(5 14)(7 16)(9 15)(11 13)]
   ( 4)[2] = [(1 8)(2 6)(3 14)(4 16)(5 10)(7 12)(9 11)(13 15)]
   ( 5)[2] = [(1 9)(2 11)(3 12)(4 10)(5 7)(6 15)(8 13)(14 16)]
   ( 6)[2] = [(1 15)(2 13)(3 4)(5 16)(6 9)(7 14)(8 11)(10 12)]
   ( 7)[4] = [(1 3 6 10)(2 4 8 12)(5 9 14 15)(7 11 16 13)]
   ( 8)[4] = [(1 7 6 16)(2 5 8 14)(3 13 10 11)(4 15 12 9)]
   ( 9)[4] = [(1 10 6 3)(2 12 8 4)(5 15 14 9)(7 13 16 11)]
   (10)[4] = [(1 11 6 13)(2 9 8 15)(3 7 10 16)(4 5 12 14)]
   (11)[4] = [(1 13 6 11)(2 15 8 9)(3 16 10 7)(4 14 12 5)]
   (12)[4] = [(1 16 6 7)(2 14 8 5)(3 11 10 13)(4 9 12 15)]
   (13)[8] = [(1 4 11 5 6 12 13 14)(2 3 9 7 8 10 15 16)]
   (14)[8] = [(1 5 13 4 6 14 11 12)(2 7 15 3 8 16 9 10)]
   (15)[8] = [(1 12 11 14 6 4 13 5)(2 10 9 16 8 3 15 7)]
   (16)[8] = [(1 14 13 12 6 5 11 4)(2 16 15 10 8 7 9 3)]
   
   Tower 1
     |C1| = 1   => [Q(y):Q] = 16
     |C2(4)| = 2 => [Q(j):Q] = 8 with j = 5/8*y^9 + 15/2*y^7 + 147/4*y^5 + 155/2*y^3 + 291/8*y
     |(C2 x C2)(1)| = 4 => [Q(e):Q] = 4 with e = -1/8*y^10 - 15/8*y^8 - 49/4*y^6 - 155/4*y^4 - 371/8*y^2 - 205/8
     |D8| = 8   => [Q(b):Q] = 2 with b = 24/2113*y^14 + 1567/16904*y^12 + 2809/8452*y^10 + 11505/16904*y^8 + 3327/4226*y^6 + 30839/16904*y^4 - 24041/8452*y^2 + 11557/16904
     |QD16| = 16 => [Q:Q]    = 1
   Tower 2
     |C1| = 1   => [Q(y):Q] = 16
     |C2(3)| = 2 => [Q(k):Q] = 8 with k = y^4 + 4*y^3 + 6*y^2 + 4*y
     |(C2 x C2)(2)| = 4 => [Q(d):Q] = 4 with d = 37/16*y^15 - 1337/16*y^11 - 2995/8*y^9 - 12599/16*y^7 - 2163/4*y^5 - 43281/16*y^3 + 50131/8*y
     |D8| = 8   => [Q(b):Q] = 2 with b = 24/2113*y^14 + 1567/16904*y^12 + 2809/8452*y^10 + 11505/16904*y^8 + 3327/4226*y^6 + 30839/16904*y^4 - 24041/8452*y^2 + 11557/16904
     |QD16| = 16 => [Q:Q]    = 1
   Tower 3
     |C1| = 1   => [Q(y):Q] = 16
     |C2(2)| = 2 => [Q(l):Q] = 8 with l = y^4 - 4*y^3 + 6*y^2 - 4*y
     |(C2 x C2)(2)| = 4 => [Q(d):Q] = 4 with d = 37/16*y^15 - 1337/16*y^11 - 2995/8*y^9 - 12599/16*y^7 - 2163/4*y^5 - 43281/16*y^3 + 50131/8*y
     |D8| = 8   => [Q(b):Q] = 2 with b = 24/2113*y^14 + 1567/16904*y^12 + 2809/8452*y^10 + 11505/16904*y^8 + 3327/4226*y^6 + 30839/16904*y^4 - 24041/8452*y^2 + 11557/16904
     |QD16| = 16 => [Q:Q]    = 1
   Tower 4
     |C1| = 1   => [Q(y):Q] = 16
     |C2(1)| = 2 => [Q(m):Q] = 8 with m = y^2
     |(C2 x C2)(1)| = 4 => [Q(e):Q] = 4 with e = -1/8*y^10 - 15/8*y^8 - 49/4*y^6 - 155/4*y^4 - 371/8*y^2 - 205/8
     |D8| = 8   => [Q(b):Q] = 2 with b = 24/2113*y^14 + 1567/16904*y^12 + 2809/8452*y^10 + 11505/16904*y^8 + 3327/4226*y^6 + 30839/16904*y^4 - 24041/8452*y^2 + 11557/16904
     |QD16| = 16 => [Q:Q]    = 1
   Tower 5
     |C1| = 1   => [Q(y):Q] = 16
     |C2| = 2   => [Q(n):Q] = 8 with n = 1/8*y^9 + 9/2*y^7 + 315/4*y^5 + 1281/2*y^3 + 12463/8*y
     |(C2 x C2)(2)| = 4 => [Q(d):Q] = 4 with d = 37/16*y^15 - 1337/16*y^11 - 2995/8*y^9 - 12599/16*y^7 - 2163/4*y^5 - 43281/16*y^3 + 50131/8*y
     |D8| = 8   => [Q(b):Q] = 2 with b = 24/2113*y^14 + 1567/16904*y^12 + 2809/8452*y^10 + 11505/16904*y^8 + 3327/4226*y^6 + 30839/16904*y^4 - 24041/8452*y^2 + 11557/16904
     |QD16| = 16 => [Q:Q]    = 1
   Tower 6
     |C1| = 1   => [Q(y):Q] = 16
     |C2| = 2   => [Q(n):Q] = 8 with n = 1/8*y^9 + 9/2*y^7 + 315/4*y^5 + 1281/2*y^3 + 12463/8*y
     |(C2 x C2)(1)| = 4 => [Q(e):Q] = 4 with e = -1/8*y^10 - 15/8*y^8 - 49/4*y^6 - 155/4*y^4 - 371/8*y^2 - 205/8
     |D8| = 8   => [Q(b):Q] = 2 with b = 24/2113*y^14 + 1567/16904*y^12 + 2809/8452*y^10 + 11505/16904*y^8 + 3327/4226*y^6 + 30839/16904*y^4 - 24041/8452*y^2 + 11557/16904
     |QD16| = 16 => [Q:Q]    = 1
   Tower 7
     |C1| = 1   => [Q(y):Q] = 16
     |C2| = 2   => [Q(n):Q] = 8 with n = 1/8*y^9 + 9/2*y^7 + 315/4*y^5 + 1281/2*y^3 + 12463/8*y
     |C4(2)| = 4 => [Q(f):Q] = 4 with f = 2481/112*y^14 + 16113/112*y^12 - 497/16*y^11 + 36595/112*y^10 - 2591/8*y^9 + 18087/112*y^8 - 11271/8*y^7 - 80667/112*y^6 - 3129*y^5 + 135717/112*y^4 - 63959/16*y^3 - 1305933/112*y^2 - 51243/8*y + 688951/112
     |Q8| = 8   => [Q(a):Q] = 2 with a = 15/112*y^15 + 121/112*y^13 + 429/112*y^11 + 877/112*y^9 + 1083/112*y^7 + 2665/112*y^5 - 3523/112*y^3 + 1721/112*y
     |QD16| = 16 => [Q:Q]    = 1
   Tower 8
     |C1| = 1   => [Q(y):Q] = 16
     |C2| = 2   => [Q(n):Q] = 8 with n = 1/8*y^9 + 9/2*y^7 + 315/4*y^5 + 1281/2*y^3 + 12463/8*y
     |C4(1)| = 4 => [Q(g):Q] = 4 with g = 2481/112*y^14 + 16113/112*y^12 + 497/16*y^11 + 36595/112*y^10 + 2591/8*y^9 + 18087/112*y^8 + 11271/8*y^7 - 80667/112*y^6 + 3129*y^5 + 135717/112*y^4 + 63959/16*y^3 - 1305933/112*y^2 + 51243/8*y + 688951/112
     |Q8| = 8   => [Q(a):Q] = 2 with a = 15/112*y^15 + 121/112*y^13 + 429/112*y^11 + 877/112*y^9 + 1083/112*y^7 + 2665/112*y^5 - 3523/112*y^3 + 1721/112*y
     |QD16| = 16 => [Q:Q]    = 1
   Tower 9
     |C1| = 1   => [Q(y):Q] = 16
     |C2| = 2   => [Q(n):Q] = 8 with n = 1/8*y^9 + 9/2*y^7 + 315/4*y^5 + 1281/2*y^3 + 12463/8*y
     |C4| = 4   => [Q(h):Q] = 4 with h = 353/16*y^13 + 21279/112*y^11 + 10329/14*y^9 + 96459/56*y^7 + 40775/16*y^5 + 581797/112*y^3 - 16511/8*y
     |Q8| = 8   => [Q(a):Q] = 2 with a = 15/112*y^15 + 121/112*y^13 + 429/112*y^11 + 877/112*y^9 + 1083/112*y^7 + 2665/112*y^5 - 3523/112*y^3 + 1721/112*y
     |QD16| = 16 => [Q:Q]    = 1
   Tower 10
     |C1| = 1   => [Q(y):Q] = 16
     |C2| = 2   => [Q(n):Q] = 8 with n = 1/8*y^9 + 9/2*y^7 + 315/4*y^5 + 1281/2*y^3 + 12463/8*y
     |C4| = 4   => [Q(h):Q] = 4 with h = 353/16*y^13 + 21279/112*y^11 + 10329/14*y^9 + 96459/56*y^7 + 40775/16*y^5 + 581797/112*y^3 - 16511/8*y
     |D8| = 8   => [Q(b):Q] = 2 with b = 24/2113*y^14 + 1567/16904*y^12 + 2809/8452*y^10 + 11505/16904*y^8 + 3327/4226*y^6 + 30839/16904*y^4 - 24041/8452*y^2 + 11557/16904
     |QD16| = 16 => [Q:Q]    = 1
   Tower 11
     |C1| = 1   => [Q(y):Q] = 16
     |C2| = 2   => [Q(n):Q] = 8 with n = 1/8*y^9 + 9/2*y^7 + 315/4*y^5 + 1281/2*y^3 + 12463/8*y
     |C4| = 4   => [Q(h):Q] = 4 with h = 353/16*y^13 + 21279/112*y^11 + 10329/14*y^9 + 96459/56*y^7 + 40775/16*y^5 + 581797/112*y^3 - 16511/8*y
     |C8| = 8   => [Q(c):Q] = 2 with c = 19581/236656*y^15 + 77247/118328*y^13 + 265113/118328*y^11 + 1029151/236656*y^9 + 1143663/236656*y^7 + 192456/14791*y^5 - 338340/14791*y^3 + 2570209/236656*y
     |QD16| = 16 => [Q:Q]    = 1
   
   # END GaloisCorrespondence Time:22.003s
   # END Time:44.216s
*/